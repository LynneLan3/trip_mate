# 409 错误完整排查

## 步骤1：强制刷新浏览器（最重要）

**按 Ctrl+Shift+R (Windows) 或 Cmd+Shift+R (Mac)**

清除浏览器缓存并重新加载，确保使用最新代码。

## 步骤2：检查是否仍然显示 on_conflict

打开浏览器 DevTools → Network 标签页，再次答题，检查请求 URL：

- ❌ 如果 URL 包含 `on_conflict=user_id%2Cquiz_id`：说明代码未更新，需要完全重启开发服务器
- ✅ 如果 URL 是普通的 POST 请求不含 on_conflict：说明代码已更新

## 步骤3：如果是代码未更新

```bash
# 停止开发服务器（Ctrl+C）
# 重新启动
npm run dev
```

## 步骤4：如果代码已更新但仍报 409

执行 SQL 脚本：`检查matches表约束.sql`

这会修复 matches 表的约束问题。

## 步骤5：终极方案

如果还不行，清空新问卷的所有数据重新开始：

```sql
-- 清空新问卷的所有记录
DELETE FROM matches WHERE quiz_id IN (
  'a0000000-0000-0000-0000-000000000001',
  'a0000000-0000-0000-0000-000000000002',
  'a0000000-0000-0000-0000-000000000003',
  'a0000000-0000-0000-0000-000000000004',
  'a0000000-0000-0000-0000-000000000005'
);

DELETE FROM quiz_results WHERE quiz_id IN (
  'a0000000-0000-0000-0000-000000000001',
  'a0000000-0000-0000-0000-000000000002',
  'a0000000-0000-0000-0000-000000000003',
  'a0000000-0000-0000-0000-000000000004',
  'a0000000-0000-0000-0000-000000000005'
);
```
